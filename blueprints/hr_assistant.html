

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-138982267-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-138982267-1');
  </script>

  <title>HR Assistant &mdash; The Conversational AI Playbook 4.3.1 documentation</title>
  


  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'4.3.1',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/custom.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@1/dist/clipboard.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Banking Assistant" href="banking.html" />
    <link rel="prev" title="Home Assistant" href="home_assistant.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> The Conversational AI Playbook
          

          
          </a>

          
            
            
              <div class="version">
                4.3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/introduction_to_conversational_applications.html">Introduction to Conversational Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/approaches_for_building_conversational_applications.html">Different Approaches for Building Conversational Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/anatomy_of_a_conversational_ai_interaction.html">Anatomy of a Conversational AI Interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/introducing_mindmeld.html">Introducing MindMeld</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/key_concepts.html">Key Concepts</a></li>
</ul>
<p class="caption"><span class="caption-text">Step-by-Step Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/00_overview.html">Building a Conversational Interface in 10 Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/01_select_the_right_use_case.html">Step 1: Select the Right Use Case</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/02_script_interactions.html">Step 2: Script Your Ideal Dialogue Interactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/03_define_the_hierarchy.html">Step 3: Define the Domain, Intent, Entity, and Role Hierarchy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/04_define_the_dialogue_handlers.html">Step 4: Define the Dialogue State Handlers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/05_create_the_knowledge_base.html">Step 5: Create the Knowledge Base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/06_generate_representative_training_data.html">Step 6: Generate Representative Training Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/07_train_the_natural_language_processing_classifiers.html">Step 7: Train the Natural Language Processing Classifiers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/08_configure_the_language_parser.html">Step 8: Configure the Language Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/09_optimize_question_answering_performance.html">Step 9: Optimize Question Answering Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/10_deploy_to_production.html">Step 10: Deploy Trained Models</a></li>
</ul>
<p class="caption"><span class="caption-text">Blueprint Applications</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">MindMeld Blueprints</a></li>
<li class="toctree-l1"><a class="reference internal" href="food_ordering.html">Food Ordering</a></li>
<li class="toctree-l1"><a class="reference internal" href="video_discovery.html">Video Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="home_assistant.html">Home Assistant</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">HR Assistant</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-use-case">1. The Use Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-dialogue-interactions">2. Example Dialogue Interactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#domain-intent-entity-hierarchy">3. Domain-Intent-Entity Hierarchy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dialogue-states">4. Dialogue States</a></li>
<li class="toctree-l2"><a class="reference internal" href="#knowledge-base">5. Knowledge Base</a></li>
<li class="toctree-l2"><a class="reference internal" href="#training-data">6. Training Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#training-the-nlp-classifiers">7. Training the NLP Classifiers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#inspect-classifiers-in-baseline-configuration">Inspect classifiers in baseline configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#experiment-with-the-intent-classifiers">Experiment with the intent classifiers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inspect-the-role-classifiers">Inspect the role classifiers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inspect-the-configuration">Inspect the configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#parser-configuration">8. Parser Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-question-answerer">9. Using the Question Answerer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-and-deployment">10. Testing and Deployment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="banking.html">Banking Assistant</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userguide/getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/architecture.html">Platform Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/optional_dependency.html">Managing Optional Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/preprocessor.html">Working with the Preprocessor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/nlp.html">Working with the Natural Language Processor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/domain_classifier.html">Working with the Domain Classifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/intent_classifier.html">Working with the Intent Classifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/entity_recognizer.html">Working with the Entity Recognizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/lstm.html">Using LSTM for Entity Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/role_classifier.html">Working with the Role Classifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/entity_resolver.html">Working with the Entity Resolver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/parser.html">Working with the Language Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/custom_features.html">Working with User-Defined Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/kb.html">Working with the Knowledge Base and Question Answerer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/dm.html">Working with the Dialogue Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/auto_annotator.html">Working with the Auto Annotator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/custom_action.html">Working with Custom Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/tokenizer.html">Working with the Tokenizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/internationalization.html">Internationalization support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/voice.html">Dealing with Voice Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/dvc.html">DVC for Model Tracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integrations/webex_teams.html">Webex Teams Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integrations/whatsapp.html">WhatsApp Integration</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../internal/api_reference.html">API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">MindMeld UI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mindmeld_ui/mindmeld_ui.html">MindMeld UI</a></li>
</ul>
<p class="caption"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../versions/changes.html">Recent Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions/history.html">Package History</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Conversational AI Playbook</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>HR Assistant</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/blueprints/hr_assistant.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="hr-assistant">
<span id="id1"></span><h1>HR Assistant<a class="headerlink" href="#hr-assistant" title="Permalink to this headline">¶</a></h1>
<p>In this step-by-step walkthrough, you'll build a conversational application for a Human Resources assistant that can answer questions about employees and general policies at a company.</p>
<p>Working through this blueprint will teach you how to</p>
<blockquote>
<div><ul class="simple">
<li>handle a large number of domains and intents</li>
<li>use system entities such as amount-of-money, dates, and times</li>
<li>query the knowledge base on multiple parameters</li>
<li>perform question answering on unstructured data</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please make sure to install and run all of the <a class="reference internal" href="../userguide/getting_started.html#getting-started-virtualenv-setup"><span class="std std-ref">pre-requisites</span></a> for MindMeld before continuing on with this blueprint tutorial.</p>
</div>
<div class="section" id="the-use-case">
<h2>1. The Use Case<a class="headerlink" href="#the-use-case" title="Permalink to this headline">¶</a></h2>
<p>This HR assistant would be used by an HR manager to ask questions about employees at an organization. They should be able to ask for information about a particular employee, for company-wide statistics, or for a group of employees that meet certain criteria.
In addition, they can also use the assistant to answer frequently asked questions about payroll, performance review and general policies.</p>
</div>
<div class="section" id="example-dialogue-interactions">
<h2>2. Example Dialogue Interactions<a class="headerlink" href="#example-dialogue-interactions" title="Permalink to this headline">¶</a></h2>
<p>The conversational flows for an HR assistant will primarily involve follow-up questions to natural language queries. Once the intent of the user is identified, multiple interactions may be necessary to get all of the information needed to complete the request.</p>
<p>Here are some examples of scripted dialogue interactions for conversational flows.</p>
<a class="reference internal image-reference" href="../_images/hr_assistant_interactions.png"><img alt="../_images/hr_assistant_interactions.png" class="align-center" src="../_images/hr_assistant_interactions.png" style="width: 700px;" /></a>
</div>
<div class="section" id="domain-intent-entity-hierarchy">
<span id="hr-assistant-model-hierarchy"></span><h2>3. Domain-Intent-Entity Hierarchy<a class="headerlink" href="#domain-intent-entity-hierarchy" title="Permalink to this headline">¶</a></h2>
<p>Here is the NLP model hierarchy for our HR assistant application.</p>
<img alt="../_images/hierarchy_hr_assistant.png" src="../_images/hierarchy_hr_assistant.png" />
<p>The HR assistant blueprint is organized into six domains: <code class="docutils literal notranslate"><span class="pre">General</span></code>, <code class="docutils literal notranslate"><span class="pre">Salary</span></code>, <code class="docutils literal notranslate"><span class="pre">Dates</span></code>, <code class="docutils literal notranslate"><span class="pre">Hierarchy</span></code>, <code class="docutils literal notranslate"><span class="pre">Unsupported</span></code>, and <code class="docutils literal notranslate"><span class="pre">Greeting</span></code>. The domains of the HR assistant blueprint correspond to the categories of questions that could be asked.</p>
<p>The full list of intents for all domains is illustrated below.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">General</span></code> domain supports the following intents:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">get_info</span></code> — User wants specific information about an employee (e.g. state, department, position, etc)</li>
<li><code class="docutils literal notranslate"><span class="pre">get_aggregate</span></code> — User wants an average, total, or percentage of employees that meet certain criteria</li>
<li><code class="docutils literal notranslate"><span class="pre">get_employees</span></code> — User wants a list of employees who meet certain criteria</li>
</ul>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">Salary</span></code> domain supports the following intents:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">get_salary</span></code> — User wants the salary of a specific employee</li>
<li><code class="docutils literal notranslate"><span class="pre">get_salary_aggregate</span></code> — User wants an average, total, or percentage specifically related to salary</li>
<li><code class="docutils literal notranslate"><span class="pre">get_salary_employees</span></code> — User wants a list of employees who meet certain criteria that include salary</li>
</ul>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">Date</span></code> domain supports the following intents:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">get_date</span></code> — User wants the birth date, hiring date, or firing date of an employee</li>
<li><code class="docutils literal notranslate"><span class="pre">get_date_range_aggregate</span></code> — User wants an average, total, or percentage filtered on a date range</li>
<li><code class="docutils literal notranslate"><span class="pre">get_date_range_employees</span></code> — User wants a list of employees who meet certain criteria filtered on a date range</li>
</ul>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">Hierarchy</span></code> domain supports the following intents:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">get_hierarchy</span></code> — User wants to know who an employee works for or who works for an employee</li>
</ul>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">Unsupported</span></code> domain supports the following intents:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">unsupported</span></code> — User has provided a query outside the scope of the HR assistant</li>
</ul>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">Greeting</span></code> domain supports the following intents:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">greet</span></code> — Greet the user and inform them of the assistant's functionality</li>
<li><code class="docutils literal notranslate"><span class="pre">exit</span></code> — Say bye to the user</li>
</ul>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">FAQ</span></code> domain supports the following intents:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">all_topics</span></code> - User asks a specific policy question</li>
<li><code class="docutils literal notranslate"><span class="pre">generic</span></code> - User indicates they want to ask a policy question</li>
</ul>
</div></blockquote>
<p>There are two types of entities in MindMeld: <a class="reference internal" href="../userguide/entity_recognizer.html#system-entities"><span class="std std-ref">System Entities</span></a> and <a class="reference internal" href="../userguide/entity_recognizer.html"><span class="doc">Custom Entities</span></a>. System entities are pre-defined in MindMeld. Examples include <code class="docutils literal notranslate"><span class="pre">sys_temperature</span></code>, <code class="docutils literal notranslate"><span class="pre">sys_time</span></code>, and <code class="docutils literal notranslate"><span class="pre">sys_interval</span></code>. Custom entities are defined by the developers of each application. Within each entity folder, the file <code class="docutils literal notranslate"><span class="pre">gazetteer.txt</span></code> contains the full list of values for each custom entity.</p>
<p>HR assistant defines and uses the following custom entities for each of its domains, which are grouped by their purpose below:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>User Information</dt>
<dd><ul class="first last">
<li><code class="docutils literal notranslate"><span class="pre">state</span></code>: detects the state referred to, for example: &quot;is {mia|name} from {CA|state}?&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">age</span></code>: detects whether the user is asking about the age of an employee. For example: &quot;tell me the {age of|age} {mia|name}&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">sex</span></code>: detects the gender of an employee. For example: &quot;is {Ivan|name} {male|sex}?&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">maritaldesc</span></code>: detects the marital status of an employee. For example: &quot;is {Ivan|name} a {married|maritaldesc} man?&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">citizendesc</span></code>: detects the citizenship status of an employee. For example: &quot;is {Nan|name} a {us citizen|citizendesc}?&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">racedesc</span></code>: detects the race of an employee. For example: &quot;is {Mia|name} {multiracial|racedesc}?&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">reason_for_termination</span></code>: detects a reason for termination for an employee. For example: &quot;Did {Mia|name} leave because of {medical issues|reason_for_termination}?&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">department</span></code>: detects the department of an employee. For example: &quot;is {Nan|name} working in {sales|department}?&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">position</span></code>: detects the position of an employee. For example: &quot;Is {Ivan|name} a {software engineer|position}?&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">manager</span></code>: detects whether the user is asking for hierarchy information. For example: &quot;Who is the {supervisor|manager} for {Mia|name}?&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">employee_source</span></code>: detects how an employee heard about the company. For example: &quot;Did {mia|name} find out about us from an {information session|racedesc}?&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">performance_score</span></code>: detects the performance score of an employee. For example: &quot;Is {ivan|name} currently {performing poorly|reason_for_termination} at the company?&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">money</span></code>: detects whether the user is referring to salary information. For example: &quot;What is {ivan|name} {earning|money}&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">dob</span></code>: detects whether the user is referring to date of birth. For example: &quot;When was {Nan|name} {born|dob}?&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">employment_action</span></code>: detects whether the user is referring to hiring or firing an employee. For example: &quot;What was {ivan|name}'s {date of termination|employment_action}&quot;</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Compare/Functions</dt>
<dd><ul class="first last">
<li><code class="docutils literal notranslate"><span class="pre">comparator</span></code>: detects comparison keywords (more than, less than, equal to, between). For example: &quot;is {mia|name} {earning|money} {more than} {ivan|name}?&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">extreme</span></code>: detects extreme keywords (highest, oldest, lowest, youngest). For example: &quot;who is the {oldest|extreme} employee?&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">date_compare</span></code>: detects date comparision key words (prior to, after). For example: &quot;Was {Ivan|name} {born|dob} {prior to|date_compare} {1990|sys_time}?&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">function</span></code>: detects a function type (percent, sum, average, count). For example: &quot;What {percent|function} of employees are {women|sex}?&quot;</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Custom Time Entities</dt>
<dd><ul class="first last">
<li><code class="docutils literal notranslate"><span class="pre">time_interval</span></code>: detects a decade (1980's, 80s, eighties). For example: &quot;{how many|function} employees were {born|dob} in the {eighties|time_interval}?&quot;</li>
<li><code class="docutils literal notranslate"><span class="pre">time_recur</span></code>: detects a recurring time interval (yearly, monthly, weekly). For example: &quot;what does {ivan|name} {make|money} {monthly|time_recur}?&quot;</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>HR assistant uses three system entities: <code class="docutils literal notranslate"><span class="pre">sys_time</span></code> (time), <code class="docutils literal notranslate"><span class="pre">sys_amount-of-money</span></code> (money), <code class="docutils literal notranslate"><span class="pre">sys_number</span></code> (number). Some examples for annotation with system entities: &quot;{How many|function} employees were {born|dob} in {2009|sys_time}?&quot; and &quot;what {fraction|function} of employees {make|money} {less than|comparator} {69 grand|sys_amount-of-money}?&quot;.</p>
<div class="admonition-exercise admonition">
<p class="first admonition-title">Exercise</p>
<p class="last">To train the different machine learning models in the NLP pipeline for this app, we need labeled training data that covers all our intents and entities. To download the data and code required to run this blueprint, run the command below in a directory of your choice. (If you have already completed the Quick Start for this blueprint, you should skip this step.)</p>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python -c <span class="s2">&quot;import mindmeld as mm; mm.blueprint(&#39;hr_assistant&#39;);&quot;</span>
</pre></div>
</div>
<p>This should create a MindMeld project folder called <code class="docutils literal notranslate"><span class="pre">hr_assistant</span></code> in your current directory with the following structure:</p>
<a class="reference internal image-reference" href="../_images/hr_assistant_directory.png"><img alt="../_images/hr_assistant_directory.png" class="align-center" src="../_images/hr_assistant_directory.png" style="width: 250px;" /></a>
</div>
<div class="section" id="dialogue-states">
<h2>4. Dialogue States<a class="headerlink" href="#dialogue-states" title="Permalink to this headline">¶</a></h2>
<p>Dialogue state logic can be arbitrarily complex. Simple dialogue state handlers just return a canned text response, while sophisticated ones can call third party APIs, calculate state transitions, and return complex responses.</p>
<p>Let's begin by looking at some of the dialogue states for the intents in the <code class="docutils literal notranslate"><span class="pre">general</span></code> domain:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@app</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="n">intent</span><span class="o">=</span><span class="s1">&#39;get_info&#39;</span><span class="p">,</span> <span class="n">has_entity</span><span class="o">=</span><span class="s1">&#39;age&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_info_age</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">responder</span><span class="p">):</span>

    <span class="o">...</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="n">intent</span><span class="o">=</span><span class="s1">&#39;get_info&#39;</span><span class="p">,</span> <span class="n">has_entity</span><span class="o">=</span><span class="s1">&#39;state&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_info_state</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">responder</span><span class="p">):</span>

    <span class="o">...</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="n">intent</span><span class="o">=</span><span class="s1">&#39;get_info&#39;</span><span class="p">,</span> <span class="n">has_entity</span><span class="o">=</span><span class="s1">&#39;position&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_info_position</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">responder</span><span class="p">):</span>

    <span class="o">...</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="n">intent</span><span class="o">=</span><span class="s1">&#39;get_info&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_info_default</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">responder</span><span class="p">):</span>

    <span class="o">...</span>
</pre></div>
</div>
<p>Observe that the same intent has multiple dialogue states that specify a <code class="docutils literal notranslate"><span class="pre">has_entity</span></code> field, except for the last case which serves as the default case. In other words, Mindmeld will feed the request to the dialogue state handler if there is a match between an entity found in the user query and the entity that the dialogue state handler accepts. If none of the entities are found, Mindmeld will default to the last case that does not specify an entity. This is where the system can follow up with the user and ask for any information needed to complete the query.</p>
<p>We can see this paradigm followed in the domain <code class="docutils literal notranslate"><span class="pre">salary</span></code> as well:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@app</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="n">intent</span><span class="o">=</span><span class="s1">&#39;get_salary&#39;</span><span class="p">,</span> <span class="n">has_entity</span><span class="o">=</span><span class="s1">&#39;time_recur&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_salary_for_interval</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">responder</span><span class="p">):</span>

    <span class="o">...</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="n">intent</span><span class="o">=</span><span class="s1">&#39;get_salary&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_salary</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">responder</span><span class="p">):</span>

    <span class="o">...</span>
</pre></div>
</div>
<div class="admonition-exercise admonition">
<p class="first admonition-title">Exercise</p>
<p class="last">Analyze the way the HR assistant blueprint uses this pattern <strong>multiple dialogue states for multiple intents</strong>. Why this pattern used instead of another?</p>
</div>
<p>Sometimes a dialogue state handler needs to be aware of the context from a previous state. This happens in the <strong>follow-up request pattern</strong>. Consider this conversational interaction:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>User: Can you tell me about daniel?
App: What would you like to know about Daniel Davis?    <span class="c1"># get_info_default</span>
User: is he married
App: Daniel Davis is Single                             <span class="c1"># get_info_maritaldesc</span>
</pre></div>
</div>
<p>Observe that the first request leaves out some required information — the type of user information to query. Therefore, in the response, the application must ask the user for the missing information. Most importantly, the app needs to &quot;remember&quot; context from the first request (in this case the person that the user is referring to) to understand the user's second request, in which the user specifies the information that was missing.</p>
<p>Here is how the HR assistant blueprint implements this pattern:</p>
<ol class="arabic simple">
<li>Define the <code class="docutils literal notranslate"><span class="pre">get_info</span></code> intent</li>
<li>Define the <code class="docutils literal notranslate"><span class="pre">get_info</span></code> state (default that does not include a <code class="docutils literal notranslate"><span class="pre">has_entity</span></code>)</li>
</ol>
<p>Here are the intents and states in the HR assistant blueprint, as defined in the application dialogue handler modules in the blueprint folder.</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="24%" />
<col width="38%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Intent</th>
<th class="head">Dialogue State Name</th>
<th class="head">Dialogue State Function</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">get_info</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_info_age</span></code></td>
<td>Get the age of an employee</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">get_info</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_info_state</span></code></td>
<td>Get the state of an employee</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">get_info</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_info_maritaldesc</span></code></td>
<td>Get the marital status of an employee</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">get_info</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_info_citizendesc</span></code></td>
<td>Get the citizenship status of an employee</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">get_info</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_info_racedesc</span></code></td>
<td>Get the race of an employee</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">get_info</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_info_performance_score</span></code></td>
<td>Get the performance score of an employee</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">get_info</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_info_rft</span></code></td>
<td>Get the reason for termination of an employee</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">get_info</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_info_employee_source</span></code></td>
<td>Get how an employee heard of the company</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">get_info</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_info_position</span></code></td>
<td>Get the position of an employee</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">get_info</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_info_employment_status</span></code></td>
<td>Get the employment status of an employee</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">get_info</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_info_dept</span></code></td>
<td>Get the department that an employee is in</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">get_info</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_info_default</span></code></td>
<td>Clarify the type of info requested of an employee</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">get_aggregate</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_aggregate</span></code></td>
<td>Get aggregate information requested</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">get_employees</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_employees</span></code></td>
<td>Get employees that meet a certain criteria</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">get_salary</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_salary</span></code></td>
<td>Get the salary of an employee</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">get_salary_aggregate</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_salary_aggregate</span></code></td>
<td>Get aggregate salary related information</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">get_salary_employees</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_salary_employees</span></code></td>
<td>Get employees that meet a salary criteria</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">get_date</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_date</span></code></td>
<td>Get employees within a date range</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">get_date_range_aggregate</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_date_range_aggregate</span></code></td>
<td>Aggregate info of employees within a date range</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">get_date_range_employees</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_date_range_employees</span></code></td>
<td>Get employees within a date range</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">get_hierarchy</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">get_hierarchy</span></code></td>
<td>Get manager information of an employee</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">unsupported</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">unsupported</span></code></td>
<td>Handle unsupported query by prompting user</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">greet</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">greet</span></code></td>
<td>Greet the user and describe functionality</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">exit</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">exit</span></code></td>
<td>Say bye to the user</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">generic</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">generic</span></code></td>
<td>Prompt the user for a specific policy question</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">all_topics</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">all_topics</span></code></td>
<td>Reply with the answer to the asked policy question</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="knowledge-base">
<h2>5. Knowledge Base<a class="headerlink" href="#knowledge-base" title="Permalink to this headline">¶</a></h2>
<p>The knowledge base for our HR assistant app leverages a publicly available synthetic dataset from <a class="reference external" href="https://www.kaggle.com/rhuebner/human-resources-data-set">Kaggle</a> and frequently asked human resources questions from <a class="reference external" href="https://hr.berkeley.edu/faq-page">UC Berkeley</a>. The knowledge base comprises of two indices in <a class="reference external" href="https://www.elastic.co/products/elasticsearch">Elasticsearch</a>:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">user_data</span></code> — information about employees</li>
<li><code class="docutils literal notranslate"><span class="pre">faq_data</span></code> - frequently asked question answer pairs</li>
</ul>
</div></blockquote>
<p>For example, here's the knowledge base entry in the <code class="docutils literal notranslate"><span class="pre">user_data</span></code> index for the employee &quot;Mia Brown&quot;:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;emp_name&quot;</span><span class="o">:</span> <span class="s2">&quot;Brown, Mia&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="mf">1103024456</span><span class="p">,</span>
    <span class="s2">&quot;state&quot;</span><span class="o">:</span> <span class="s2">&quot;MA&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dob&quot;</span><span class="o">:</span> <span class="s2">&quot;1985-11-24&quot;</span><span class="p">,</span>
    <span class="s2">&quot;age&quot;</span><span class="o">:</span> <span class="mf">32</span><span class="p">,</span>
    <span class="s2">&quot;sex&quot;</span><span class="o">:</span> <span class="s2">&quot;Female&quot;</span><span class="p">,</span>
    <span class="s2">&quot;maritaldesc&quot;</span><span class="o">:</span> <span class="s2">&quot;Married&quot;</span><span class="p">,</span>
    <span class="s2">&quot;citizendesc&quot;</span><span class="o">:</span> <span class="s2">&quot;US Citizen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;racedesc&quot;</span><span class="o">:</span> <span class="s2">&quot;Black or African American&quot;</span><span class="p">,</span>
    <span class="s2">&quot;doh&quot;</span><span class="o">:</span> <span class="s2">&quot;2008-10-27&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dot&quot;</span><span class="o">:</span> <span class="s2">&quot;1800-01-01&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rft&quot;</span><span class="o">:</span> <span class="s2">&quot;N/A - still employed&quot;</span><span class="p">,</span>
    <span class="s2">&quot;employment_status&quot;</span><span class="o">:</span> <span class="s2">&quot;Active&quot;</span><span class="p">,</span>
    <span class="s2">&quot;department&quot;</span><span class="o">:</span> <span class="s2">&quot;Admin Offices&quot;</span><span class="p">,</span>
    <span class="s2">&quot;position&quot;</span><span class="o">:</span> <span class="s2">&quot;Accountant I&quot;</span><span class="p">,</span>
    <span class="s2">&quot;money&quot;</span><span class="o">:</span> <span class="mf">28.5</span><span class="p">,</span>
    <span class="s2">&quot;manager&quot;</span><span class="o">:</span> <span class="s2">&quot;Brandon R. LeBlanc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;employee_source&quot;</span><span class="o">:</span> <span class="s2">&quot;Diversity Job Fair&quot;</span><span class="p">,</span>
    <span class="s2">&quot;performance_score&quot;</span><span class="o">:</span> <span class="s2">&quot;Fully Meets&quot;</span><span class="p">,</span>
    <span class="s2">&quot;first_name&quot;</span><span class="o">:</span> <span class="s2">&quot;Mia&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last_name&quot;</span><span class="o">:</span> <span class="s2">&quot;Brown&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here's another example with a knowledge base entry in the <code class="docutils literal notranslate"><span class="pre">faq_data</span></code> index:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;hrfaq24&quot;</span><span class="p">,</span>
    <span class="s2">&quot;question&quot;</span><span class="o">:</span> <span class="s2">&quot;What is the performance cycle?&quot;</span><span class="p">,</span>
    <span class="s2">&quot;answer&quot;</span><span class="o">:</span> <span class="s2">&quot;The intent of the performance cycle is to identify the key parts of each employee&#39;s job, identify what it looks like when that is done well (meets your expectations as a manager), and how both you as manager and your employee will know when that is achieved (measurements).Phase 1 - Planning:  Creating goals and expectations between the employee and manager for the current year. Phase 2 - Check-Ins:  Giving ongoing feedback throughout the year; identifying acomplishments, areas for improvement and adjusting the goals/expectations as necessary. Phase 3 - Review:  Reviewing the year at the end of the performance period.&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Assuming that you have Elasticsearch installed, running the <code class="xref py py-func docutils literal notranslate"><span class="pre">blueprint()</span></code> command described above should build the knowledge base for the HR assistant app by creating the index and importing all the necessary data. To verify that the knowledge base has been set up correctly, use the <a class="reference internal" href="../userguide/kb.html"><span class="doc">Question Answerer</span></a> to query the indexes.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindmeld.components.question_answerer</span> <span class="kn">import</span> <span class="n">QuestionAnswerer</span>
<span class="n">qa</span> <span class="o">=</span> <span class="n">QuestionAnswerer</span><span class="p">(</span><span class="n">app_path</span><span class="o">=</span><span class="s1">&#39;hr_assistant&#39;</span><span class="p">)</span>
<span class="n">qa</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;user_data&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">{</span>
<span class="go">  &#39;rft&#39;: &#39;N/A - still employed&#39;,</span>
<span class="go">   &#39;performance_score&#39;: &#39;N/A- too early to review&#39;,</span>
<span class="go">   &#39;citizendesc&#39;: &#39;US Citizen&#39;,</span>
<span class="go">   &#39;manager&#39;: &#39;Brandon R. LeBlanc&#39;,</span>
<span class="go">   &#39;sex&#39;: &#39;Female&#39;,</span>
<span class="go">   &#39;maritaldesc&#39;: &#39;Single&#39;,</span>
<span class="go">   &#39;emp_name&#39;: &#39;Singh, Nan &#39;,</span>
<span class="go">   &#39;dot&#39;: &#39;1800-01-01&#39;,</span>
<span class="go">   &#39;last_name&#39;: &#39;Singh&#39;,</span>
<span class="go">   &#39;racedesc&#39;: &#39;White&#39;,</span>
<span class="go">   &#39;money&#39;: 16.56,</span>
<span class="go">   &#39;dob&#39;: &#39;1988-05-19&#39;,</span>
<span class="go">   &#39;employee_source&#39;: &#39;Website Banner Ads&#39;,</span>
<span class="go">   &#39;id&#39;: 1307059817,</span>
<span class="go">   &#39;state&#39;: &#39;MA&#39;,</span>
<span class="go">   &#39;employment_status&#39;: &#39;Active&#39;,</span>
<span class="go">   &#39;position&#39;: &#39;Administrative Assistant&#39;,</span>
<span class="go">   &#39;doh&#39;: &#39;2015-05-01&#39;,</span>
<span class="go">   &#39;department&#39;: &#39;Admin Offices&#39;,</span>
<span class="go">   &#39;first_name&#39;: &#39;Nan&#39;,</span>
<span class="go">   &#39;age&#39;: 29</span>
<span class="go"> }</span>
</pre></div>
</div>
<div class="admonition-exercise admonition">
<p class="first admonition-title">Exercise</p>
<p class="last">The blueprint comes with a pre-configured, pre-populated knowledge base to help you get up and running quickly. Read the User Guide section on <a class="reference internal" href="../userguide/kb.html"><span class="doc">Question Answerer</span></a> to learn how to create knowledge base indices from scratch. Then, try creating one or more knowledge base indices for your own data.</p>
</div>
</div>
<div class="section" id="training-data">
<h2>6. Training Data<a class="headerlink" href="#training-data" title="Permalink to this headline">¶</a></h2>
<p>The labeled data for training our NLP pipeline was created using a combination of in-house data generation and crowdsourcing techniques. This is a highly important multi-step process that is described in more detail in <a class="reference internal" href="../quickstart/06_generate_representative_training_data.html"><span class="doc">Step 6</span></a> of the Step-By-Step Guide. Be aware that at minimum, the following data generation tasks are required:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Purpose</div>
<div class="line"><br /></div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Question (for crowdsourced data generators)</div>
<div class="line">or instruction (for annotators)</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Exploratory data generation</div>
<div class="line">for guiding the app design</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">&quot;What kinds of questions would you ask a smart HR assistant</div>
<div class="line">that has access to an HR database?&quot;</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">Generate queries for training</div>
<div class="line">Domain and Intent Classifiers</div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">get_info</span></code> intent (<code class="docutils literal notranslate"><span class="pre">general</span></code> domain):</div>
<div class="line">&quot;How would you ask for an employee's information such as state,</div>
<div class="line">position, department, etc?&quot;</div>
<div class="line"><br /></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">get_salary</span></code> intent (<code class="docutils literal notranslate"><span class="pre">salary</span></code> domain):</div>
<div class="line">&quot;How would you ask for the salary</div>
<div class="line">of an employee?&quot;</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Annotate queries</div>
<div class="line">for training the Entity Recognizer</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">get_info</span></code>: &quot;Annotate all occurrences of</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">name</span></code> and other user info entities in the given query&quot;</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">Annotate queries</div>
<div class="line">for training the Role Classifier</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">HR Assistant does not use roles. For examples please visit</div>
<div class="line">the home assistant blueprint.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Generation synonyms for gazetteer generation</div>
<div class="line">to improve entity recognition accuracies</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">state</span></code> entity: &quot;Enumerate a list of state names&quot;</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">department</span></code> entity: &quot;What are some names of</div>
<div class="line">departments at the company?&quot;</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>In summary, the process is this:</p>
<ol class="arabic simple">
<li>Start with an exploratory data generation process, collecting varied examples of how the end user would interact with the app.</li>
<li>Cluster the data into different domains based on category. For example, the HR Assistant application has to answer questions regarding general information, salary, date filters, and hierarchy so we divide these areas into the following domains: <code class="docutils literal notranslate"><span class="pre">general</span></code>, <code class="docutils literal notranslate"><span class="pre">salary</span></code>, <code class="docutils literal notranslate"><span class="pre">date</span></code>, <code class="docutils literal notranslate"><span class="pre">hierarchy</span></code>, <code class="docutils literal notranslate"><span class="pre">unsupported</span></code> and <code class="docutils literal notranslate"><span class="pre">greeting</span></code>.</li>
<li>Once we establish a clear domain-intent-entity-role hierarchy, generate labeled data for each component in the hierarchy.</li>
</ol>
<p>The <code class="docutils literal notranslate"><span class="pre">domains</span></code> directory contains the training data for intent classification and entity recognition. The <code class="docutils literal notranslate"><span class="pre">entities</span></code> directory contains the data for entity resolution. Directories are at root level in the blueprint folder.</p>
<div class="admonition-exercise admonition">
<p class="first admonition-title">Exercise</p>
<ul class="last simple">
<li>Read <a class="reference internal" href="../quickstart/06_generate_representative_training_data.html"><span class="doc">Step 6</span></a> of the Step-By-Step Guide for best practices around training data generation and annotation for conversational apps. Following those principles, create additional labeled data for all the intents in this blueprint and use them as held-out validation data for evaluating your app. You can read more about <a class="reference internal" href="../userguide/nlp.html"><span class="doc">NLP model evaluation and error analysis</span></a> in the user guide.</li>
<li>To train NLP models for your own HR assistant application, you can start by reusing the blueprint data for generic intents like <code class="docutils literal notranslate"><span class="pre">get_info</span></code> and <code class="docutils literal notranslate"><span class="pre">get_salary</span></code>. If you have more information in your HR database then you can create new intents and domains to include the new functionality.</li>
</ul>
</div>
</div>
<div class="section" id="training-the-nlp-classifiers">
<h2>7. Training the NLP Classifiers<a class="headerlink" href="#training-the-nlp-classifiers" title="Permalink to this headline">¶</a></h2>
<p>Train a baseline NLP system for the blueprint app. The <code class="xref py py-meth docutils literal notranslate"><span class="pre">build()</span></code> method of the <code class="xref py py-class docutils literal notranslate"><span class="pre">NaturalLanguageProcessor</span></code> class, used as shown below, applies MindMeld's default machine learning settings.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindmeld</span> <span class="kn">import</span> <span class="n">configure_logs</span><span class="p">;</span> <span class="n">configure_logs</span><span class="p">()</span>
<span class="kn">from</span> <span class="nn">mindmeld.components.nlp</span> <span class="kn">import</span> <span class="n">NaturalLanguageProcessor</span>
<span class="n">nlp</span> <span class="o">=</span> <span class="n">NaturalLanguageProcessor</span><span class="p">(</span><span class="n">app_path</span><span class="o">=</span><span class="s1">&#39;./hr_assistant&#39;</span><span class="p">)</span>
<span class="n">nlp</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Fitting domain classifier</span>
<span class="go">Loading raw queries from file hr_assistant/domains/date/get_date/train.txt</span>
<span class="go">Loading raw queries from file hr_assistant/domains/date/get_date_range_aggregate/train.txt</span>
<span class="go">Loading raw queries from file hr_assistant/domains/date/get_date_range_employees/train.txt</span>
<span class="go">Loading raw queries from file hr_assistant/domains/faq/all_topics/train.txt</span>
<span class="go">.</span>
<span class="go">.</span>
<span class="go">.</span>
<span class="go">Fitting intent classifier: domain=&#39;greeting&#39;</span>
<span class="go">Selecting hyperparameters using k-fold cross-validation with 5 splits</span>
<span class="go">Best accuracy: 98.86%, params: {&#39;C&#39;: 1, &#39;class_weight&#39;: {0: 1.5041516245487365, 1: 0.8843956953642383}, &#39;fit_intercept&#39;: False}</span>
<span class="go">Fitting entity recognizer: domain=&#39;greeting&#39;, intent=&#39;greet&#39;</span>
<span class="go">No entity model configuration set. Using default.</span>
<span class="go">There are no labels in this label set, so we don&#39;t fit the model.</span>
<span class="go">.</span>
<span class="go">.</span>
<span class="go">.</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">During active development, it helps to increase the <a class="reference internal" href="../userguide/getting_started.html"><span class="doc">MindMeld logging level</span></a> to better understand what is happening behind the scenes. All code snippets here assume that logging level is set to verbose.</p>
</div>
<p>To see how the trained NLP pipeline performs on a test query, use the <code class="xref py py-meth docutils literal notranslate"><span class="pre">process()</span></code> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nlp</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="s2">&quot;is Mia brown in the sales department?&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">{&#39;text&#39;: &#39;is Mia brown in the sales department?&#39;,</span>
<span class="go"> &#39;domain&#39;: &#39;general&#39;,</span>
<span class="go"> &#39;intent&#39;: &#39;get_info&#39;,</span>
<span class="go"> &#39;entities&#39;: [{&#39;text&#39;: &#39;Mia brown&#39;,</span>
<span class="go">   &#39;type&#39;: &#39;name&#39;,</span>
<span class="go">   &#39;role&#39;: None,</span>
<span class="go">   &#39;value&#39;: [{&#39;cname&#39;: &#39;Mia Brown&#39;,</span>
<span class="go">     &#39;score&#39;: 120.39465,</span>
<span class="go">     &#39;top_synonym&#39;: &#39;Mia Brown&#39;},</span>
<span class="go">    {&#39;cname&#39;: &#39;Thelma Petrowsky&#39;,</span>
<span class="go">     &#39;score&#39;: 11.883775,</span>
<span class="go">     &#39;top_synonym&#39;: &#39;Petrowsky&#39;},</span>
<span class="go">    {&#39;cname&#39;: &#39;Brooke Oliver&#39;, &#39;score&#39;: 11.557489, &#39;top_synonym&#39;: &#39;Brooke&#39;},</span>
<span class="go">    {&#39;cname&#39;: &#39;Jeremiah Semizoglou&#39;,</span>
<span class="go">     &#39;score&#39;: 10.367119,</span>
<span class="go">     &#39;top_synonym&#39;: &#39;Jeremiah&#39;}],</span>
<span class="go">   &#39;span&#39;: {&#39;start&#39;: 3, &#39;end&#39;: 11}},</span>
<span class="go">  {&#39;text&#39;: &#39;sales&#39;,</span>
<span class="go">   &#39;type&#39;: &#39;department&#39;,</span>
<span class="go">   &#39;role&#39;: None,</span>
<span class="go">   &#39;value&#39;: [{&#39;cname&#39;: &#39;sales&#39;, &#39;score&#39;: 33.45853, &#39;top_synonym&#39;: &#39;sales&#39;}],</span>
<span class="go">   &#39;span&#39;: {&#39;start&#39;: 20, &#39;end&#39;: 24}}]</span>
<span class="go">}</span>
</pre></div>
</div>
<div class="section" id="inspect-classifiers-in-baseline-configuration">
<h3>Inspect classifiers in baseline configuration<a class="headerlink" href="#inspect-classifiers-in-baseline-configuration" title="Permalink to this headline">¶</a></h3>
<p>For the data distributed with this blueprint, the baseline performance is already high. However, when extending the blueprint with your own custom hr assistant data, you may find that the default settings may not be optimal and you can get better accuracy by individually optimizing each of the NLP components.</p>
<p>Because the HR assistant app has five domains and over twenty intents, the classifiers need a fair amount of fine-tuning.</p>
<p>Start by inspecting the baseline configurations that the different classifiers use. The User Guide lists and describes the available configuration options. As an example, the code below shows how to access the model and feature extraction settings for the intent classifier.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ic</span> <span class="o">=</span> <span class="n">nlp</span><span class="o">.</span><span class="n">domains</span><span class="p">[</span><span class="s1">&#39;salary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">intent_classifier</span>
<span class="n">ic</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">model_settings</span><span class="p">[</span><span class="s1">&#39;classifier_type&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&#39;logreg&#39;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ic</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">features</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">{&#39;bag-of-words&#39;: {&#39;lengths&#39;: [1, 2]},</span>
<span class="go"> &#39;edge-ngrams&#39;: {&#39;lengths&#39;: [1, 2]},</span>
<span class="go"> &#39;exact&#39;: {&#39;scaling&#39;: 10},</span>
<span class="go"> &#39;freq&#39;: {&#39;bins&#39;: 5},</span>
<span class="go"> &#39;gaz-freq&#39;: {},</span>
<span class="go"> &#39;in-gaz&#39;: {}</span>
<span class="go">}</span>
</pre></div>
</div>
<p>You can experiment with different learning algorithms (model types), features, hyperparameters, and cross-validation settings, by passing the appropriate parameters to the classifier's <code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code> method. Intent classifer and role classifier examples follow.</p>
</div>
<div class="section" id="experiment-with-the-intent-classifiers">
<h3>Experiment with the intent classifiers<a class="headerlink" href="#experiment-with-the-intent-classifiers" title="Permalink to this headline">¶</a></h3>
<p>We can change the feature extraction settings to use bag of trigrams in addition to the default bag of words:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ic</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="s1">&#39;bag-of-words&#39;</span><span class="p">][</span><span class="s1">&#39;lengths&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ic</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Fitting intent classifier: domain=&#39;salary&#39;</span>
<span class="go">Selecting hyperparameters using k-fold cross-validation with 5 splits</span>
<span class="go">Best accuracy: 97.20%, params: {&#39;C&#39;: 100, &#39;class_weight&#39;: {0: 0.9612578616352201, 1: 1.0065860215053766, 2: 1.0362745098039214}, &#39;fit_intercept&#39;: True}</span>
</pre></div>
</div>
<p>We can also change the model for the intent classifier to Support Vector Machine (SVM) classifier, which works well for some datasets:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">search_grid</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">],</span>
   <span class="s1">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="s1">&#39;poly&#39;</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">param_selection_settings</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s1">&#39;grid&#39;</span><span class="p">:</span> <span class="n">search_grid</span><span class="p">,</span>
     <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;k-fold&#39;</span><span class="p">,</span>
     <span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="mi">10</span>
<span class="p">}</span>

<span class="n">ic</span> <span class="o">=</span> <span class="n">nlp</span><span class="o">.</span><span class="n">domains</span><span class="p">[</span><span class="s1">&#39;salary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">intent_classifier</span>
<span class="n">ic</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model_settings</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;classifier_type&#39;</span><span class="p">:</span> <span class="s1">&#39;svm&#39;</span><span class="p">},</span> <span class="n">param_selection</span><span class="o">=</span><span class="n">param_selection_settings</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Fitting intent classifier: domain=&#39;salary&#39;</span>
<span class="go">Selecting hyperparameters using k-fold cross-validation with 10 splits</span>
<span class="go">Best accuracy: 98.00%, params: {&#39;C&#39;: 0.5, &#39;kernel&#39;: &#39;linear&#39;}</span>
</pre></div>
</div>
<p>Similar options are available for inspecting and experimenting with the Entity Recognizer and other NLP classifiers as well. Finding the optimal machine learning settings is an iterative process involving several rounds of parameter tuning, testing, and error analysis. Refer to the <a class="reference internal" href="../userguide/nlp.html"><span class="doc">NaturalLanguageProcessor</span></a> in the user guide for more about training, tuning, and evaluating the various MindMeld classifiers.</p>
</div>
<div class="section" id="inspect-the-role-classifiers">
<h3>Inspect the role classifiers<a class="headerlink" href="#inspect-the-role-classifiers" title="Permalink to this headline">¶</a></h3>
<p>The HR assistant does not make use of the role classifiers. For an example of inspecting the role classifiers please visit the home assistant application blueprint.</p>
</div>
<div class="section" id="inspect-the-configuration">
<h3>Inspect the configuration<a class="headerlink" href="#inspect-the-configuration" title="Permalink to this headline">¶</a></h3>
<p>The application configuration file, <code class="docutils literal notranslate"><span class="pre">config.py</span></code>, at the top level of the home assistant folder, contains custom intent and domain classifier model configurations. These are defined as dictionaries named <code class="docutils literal notranslate"><span class="pre">DOMAIN_CLASSIFIER_CONFIG</span></code> and <code class="docutils literal notranslate"><span class="pre">INTENT_CLASSIFIER_CONFIG</span></code>, respectively; other dictionaries include <code class="docutils literal notranslate"><span class="pre">ENTITY_RECOGNIZER_CONFIG</span></code> and <code class="docutils literal notranslate"><span class="pre">ROLE_CLASSIFIER_CONFIG</span></code>. If no custom model configuration is added to <code class="docutils literal notranslate"><span class="pre">config.py</span></code> file, MindMeld uses its default classifier configurations for training and evaluation. Here is an example of an intent configuration:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">INTENT_CLASSIFIER_CONFIG</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;model_type&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span>
    <span class="s1">&#39;model_settings&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;classifier_type&#39;</span><span class="p">:</span> <span class="s1">&#39;logreg&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;param_selection&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;k-fold&#39;</span><span class="p">,</span>
        <span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="s1">&#39;grid&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;fit_intercept&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
            <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
            <span class="s1">&#39;class_bias&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;bag-of-words&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;lengths&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="s2">&quot;edge-ngrams&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lengths&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]},</span>
        <span class="s2">&quot;in-gaz&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">&quot;exact&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;scaling&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
        <span class="s2">&quot;gaz-freq&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">&quot;freq&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;bins&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition-exercise admonition">
<p class="first admonition-title">Exercise</p>
<p class="last">Experiment with different models, features, and hyperparameter selection settings to see how they affect the classifier performance. Maintain a held-out validation set to evaluate your trained NLP models and analyze the misclassified test instances. Then use observations from the error analysis to inform your machine learning experimentation. For more on this topic, refer to the <a class="reference internal" href="../userguide/nlp.html"><span class="doc">User Guide</span></a>.</p>
</div>
</div>
</div>
<div class="section" id="parser-configuration">
<h2>8. Parser Configuration<a class="headerlink" href="#parser-configuration" title="Permalink to this headline">¶</a></h2>
<p>The relationships between entities in the HR assistant queries are simple ones. For example, in the annotated query <code class="docutils literal notranslate"><span class="pre">is</span> <span class="pre">{mia|name}</span> <span class="pre">{married|maritaldesc}?</span></code>, the <code class="docutils literal notranslate"><span class="pre">maritaldesc</span></code> entity is self-sufficient, in that it is not described by any other entity.</p>
<p>If you extended the app to support queries with more complex entity relationships, it would be necessary to specify <em>entity groups</em> and configure the parser accordingly. For more about entity groups and parser configurations, see the <a class="reference internal" href="../userguide/parser.html"><span class="doc">Language Parser</span></a> chapter of the User Guide.</p>
<p>Since we do not have entity groups in the HR assistant app, we do not need a parser configuration.</p>
</div>
<div class="section" id="using-the-question-answerer">
<h2>9. Using the Question Answerer<a class="headerlink" href="#using-the-question-answerer" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../userguide/kb.html"><span class="doc">Question Answerer</span></a> component in MindMeld is mainly used within dialogue state handlers for retrieving information from the knowledge base. In the case of an HR assistant that intelligently retrieves information from a knowledge base of employee information or policy questions, a question answerer is essential. Other than the unsupported intent, all of the intents in the HR Assistant make use of the Question Answerer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindmeld.components</span> <span class="kn">import</span> <span class="n">QuestionAnswerer</span>
<span class="n">qa</span> <span class="o">=</span> <span class="n">QuestionAnswerer</span><span class="p">(</span><span class="n">app_path</span><span class="o">=</span><span class="s1">&#39;hr_assistant&#39;</span><span class="p">)</span>
<span class="n">users</span> <span class="o">=</span> <span class="n">qa</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;user_data&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;emp_name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[</span>
<span class="go"> &quot;Singh, Nan&quot;,</span>
<span class="go"> &quot;Simard, Kramer&quot;,</span>
<span class="go"> &quot;Clayton, Rick&quot;</span>
<span class="go">]</span>
</pre></div>
</div>
<p>MindMeld would supports filtering the results (For example, we can search for employees that are male, in the sales department, etc.) See the <a class="reference internal" href="../userguide/kb.html"><span class="doc">User Guide</span></a> for an explanation of the retrieval and ranking mechanisms that the Question Answerer offers.</p>
<p>In the case that we are trying to filter on multiple non-numeric entities, we can do so by passing in a dictionary that contains a key and value pair. An example of this is shown in the helper function for the HR Assistant below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">_resolve_categorical_entities</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">responder</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This function retrieves all categorical entities as listed below and filters the knowledge base</span>
<span class="sd">  using these entities as filters. The final search object containing the shortlisted employee data</span>
<span class="sd">  is returned back to the calling function.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="c1"># Finding all categorical entities</span>
  <span class="n">categorical_entities</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">entities</span> <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="s1">&#39;maritaldesc&#39;</span><span class="p">,</span><span class="s1">&#39;citizendesc&#39;</span><span class="p">,</span>
          <span class="s1">&#39;racedesc&#39;</span><span class="p">,</span><span class="s1">&#39;performance_score&#39;</span><span class="p">,</span><span class="s1">&#39;employment_status&#39;</span><span class="p">,</span><span class="s1">&#39;employee_source&#39;</span><span class="p">,</span><span class="s1">&#39;position&#39;</span><span class="p">,</span><span class="s1">&#39;department&#39;</span><span class="p">)]</span>

  <span class="c1"># Building custom search</span>
  <span class="n">qa</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">question_answerer</span><span class="o">.</span><span class="n">build_search</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;user_data&#39;</span><span class="p">)</span>

  <span class="c1"># Querying the knowledge base for all categorical filters</span>
  <span class="k">if</span> <span class="n">categorical_entities</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
                  <span class="k">for</span> <span class="n">categorical_entity</span> <span class="ow">in</span> <span class="n">categorical_entities</span><span class="p">:</span>
                          <span class="n">key</span> <span class="o">=</span> <span class="n">categorical_entity</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
                          <span class="n">val</span> <span class="o">=</span> <span class="n">categorical_entity</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;cname&#39;</span><span class="p">]</span>
                          <span class="n">kw</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span> <span class="p">:</span> <span class="n">val</span><span class="p">}</span>
                          <span class="n">qa</span> <span class="o">=</span> <span class="n">qa</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span> <span class="c1"># Search is being filtered multiple times</span>
          <span class="k">except</span><span class="p">:</span>
                  <span class="k">pass</span>

  <span class="n">size</span> <span class="o">=</span> <span class="mi">300</span>

  <span class="k">return</span> <span class="n">qa</span><span class="p">,</span> <span class="n">size</span>
</pre></div>
</div>
<p>For the <code class="docutils literal notranslate"><span class="pre">faq</span></code> domain, given the user query, the Question Answerer has to retrieve information from a knowledge base that consists of long-form text in the form of question-answer pairs. See <a class="reference internal" href="../userguide/kb.html"><span class="doc">User Guide</span></a> to learn more about how MindMeld retrieves and ranks unstructured data.
In the HR blueprint, we use both question and answer field to rank the KB entries. Depending on the domain and coverage of data, you may want to experiment with ranking on multiple fields.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindmeld.components</span> <span class="kn">import</span> <span class="n">QuestionAnswerer</span>
<span class="n">qa</span> <span class="o">=</span> <span class="n">QuestionAnswerer</span><span class="p">(</span><span class="n">app_path</span><span class="o">=</span><span class="s1">&#39;hr_assistant&#39;</span><span class="p">)</span>
<span class="n">qa</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;faq_data&#39;</span><span class="p">,</span> <span class="n">query_type</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">question</span><span class="o">=</span><span class="s1">&#39;how are overtime hours determined?&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">{</span>
<span class="go"> &#39;question&#39;: &#39;How is my overtime compensation calculated?&#39;,</span>
<span class="go"> &#39;answer&#39;: &#39;Overtime is paid at the rate of one and one-half times an employee’s regular rate of pay for all hours worked in excess of forty (40) hours in a standard work week. “Hours worked” refers to the amount of time actually worked in a standard work week. Paid time off for sick leave, vacation, or holidays is not included in hours worked for the determination of overtime. Overtime hours and compensation is based on calculation using the above rate.&#39;,</span>
<span class="go"> &#39;id&#39;: &#39;hrfaq9&#39;</span>
<span class="go">}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindmeld.components</span> <span class="kn">import</span> <span class="n">QuestionAnswerer</span>
<span class="n">qa</span> <span class="o">=</span> <span class="n">QuestionAnswerer</span><span class="p">(</span><span class="n">app_path</span><span class="o">=</span><span class="s1">&#39;hr_assistant&#39;</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;is there an online course on how to set goals?&#39;</span>
<span class="n">qa</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;faq_data&#39;</span><span class="p">,</span> <span class="n">query_type</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">question</span><span class="o">=</span><span class="n">query</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">qa</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;faq_data&#39;</span><span class="p">,</span> <span class="n">query_type</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">question</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">answer</span><span class="o">=</span><span class="n">query</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">{</span>
<span class="go"> &#39;question&#39;: &#39;How do I set goals?&#39;,</span>
<span class="go"> &#39;answer&#39;: &#39;Meet with your employee. Identify and agree on major pieces of the job. Use that list to determine performance for the year. Start the next period by identifying the major pieces of the job, what success looks like, and how that might be measured.&#39;,</span>
<span class="go"> &#39;id&#39;: &#39;hrfaq29&#39;</span>
<span class="go">}</span>
<span class="go">{</span>
<span class="go"> &#39;question&#39;: &#39;Will there be training on goal setting for Managers and Supervisors?&#39;,</span>
<span class="go"> &#39;answer&#39;: &#39;Yes! Our classes provide detailed support on how to set goals. This program is offered twice a year based on the timing of the performance cycle. There is a online course (sign-up on blu) titled &quot;Setting Expectations and Individual Performance Goals.&quot; Additionally, Staff Learning and Development offers training for work teams upon request.&#39;,</span>
<span class="go"> &#39;id&#39;: &#39;hrfaq30&#39;</span>
<span class="go">}</span>
</pre></div>
</div>
<div class="admonition-exercise admonition">
<p class="first admonition-title">Exercise</p>
<ul class="last simple">
<li>Think of other important data that would be useful to have in the knowledge base for an HR Assistant use case. Identify the ways that data could be leveraged to provide a more intelligent user experience.</li>
<li>When customizing the blueprint for your own app, consider adding additional employee information in the knowledge base.</li>
</ul>
</div>
</div>
<div class="section" id="testing-and-deployment">
<h2>10. Testing and Deployment<a class="headerlink" href="#testing-and-deployment" title="Permalink to this headline">¶</a></h2>
<p>Once all the individual pieces (NLP, Dialogue State Handlers) have been trained, configured or implemented, perform an end-to-end test of the app using the <code class="xref py py-class docutils literal notranslate"><span class="pre">Conversation</span></code> class.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindmeld.components.dialogue</span> <span class="kn">import</span> <span class="n">Conversation</span>
<span class="n">conv</span> <span class="o">=</span> <span class="n">Conversation</span><span class="p">(</span><span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span> <span class="n">app_path</span><span class="o">=</span><span class="s1">&#39;./hr_assistant&#39;</span><span class="p">)</span>
<span class="n">conv</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="s2">&quot;What is Elisa&#39;s marital status&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[&#39;Elisa Bramante is Single&#39;]</span>
</pre></div>
</div>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">say()</span></code> method:</p>
<blockquote>
<div><ul class="simple">
<li>packages the input text in a user request object</li>
<li>passes the object to the MindMeld Application Manager to a simulate an external user interaction with the app, and</li>
<li>outputs the textual part of the response sent by the dialogue manager.</li>
</ul>
</div></blockquote>
<p>In the above example, we requested information about a particular employee and the app responded, as expected, by identifying the employee referenced by just the first name and the type of information requested about the employee.</p>
<p>Try a multi-turn dialogue:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conv</span> <span class="o">=</span> <span class="n">Conversation</span><span class="p">(</span><span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span> <span class="n">app_path</span><span class="o">=</span><span class="s1">&#39;hr_assistant&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conv</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="s1">&#39;Tell me about Mia Brown&#39;</span><span class="p">)</span>
<span class="go">[&#39;What information would you like to know about Mia Brown?&#39;, &#39;Listening...&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conv</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="s2">&quot;Who is her manager?&quot;</span><span class="p">)</span>
<span class="go">[&quot;Brandon R. LeBlanc is Mia Brown&#39;s manager&quot;]</span>
</pre></div>
</div>
<p>If the user goes off track, or presents a query that is out of the scope of the assistant, the app is able to recognize this and prompt the user back to what is supported. Below is an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conv</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="s2">&quot;Can you give me a million dollars please?&quot;</span><span class="p">)</span>
<span class="go">[&quot;Hmmm, I don&#39;t quite understand, you can ask me something like &#39;What is the average salary for women?&#39;&quot;,</span>
<span class="go">&#39;Listening...&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conv</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="s2">&quot;What is nan singh&#39;s hourly salary?&quot;</span><span class="p">)</span>
<span class="go">[&quot;Nan Singh&#39;s hourly salary is 16.56&quot;]</span>
</pre></div>
</div>
<p>Alternatively, enter conversation mode directly from the command-line.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python -m hr_assistant converse</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">You: Percent of employees earning less than 20 an hour?</span>
<span class="go">App: Of the total employees, the percentage that meet your criteria is 29.0</span>
</pre></div>
</div>
<div class="admonition-exercise admonition">
<p class="first admonition-title">Exercise</p>
<p class="last">Test the app and play around with different language patterns to discover edge cases that our classifiers are unable to handle. The more language patterns we can collect in our training data, the better our classifiers can handle in live usage with real users. Good luck and have fun - now you have your very own Jarvis!</p>
</div>
<div class="admonition-whatsapp-integration admonition">
<p class="first admonition-title">WhatsApp integration</p>
<p class="last">Follow our tutorial on <a class="reference internal" href="../integrations/whatsapp.html"><span class="doc">WhatsApp integration</span></a> for more information on how to integrate with WhatsApp.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="banking.html" class="btn btn-neutral float-right" title="Banking Assistant" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="home_assistant.html" class="btn btn-neutral float-left" title="Home Assistant" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Cisco Systems

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>